<div class="object" id="chest" onclick="revealInteraction('chest')"></div>
<div class="interaction" id="chest_interaction">
    <img src="objects/chest/chest.png" alt="chest" class="interaction-image">
    <div class="options" id="chest_options">
        <button onclick="openChest()">Ouvrir</button>
        <button onclick="closeInteraction('chest_interaction');">Fermer</button>
    </div>
    <div class="text"> 
        <p class="typewriter">Un énorme coffre entrouvert, assez pour y mettre un corps.</p>
    </div>
</div>

<style>
    #chest {
        background: url(objects/chest/chest.png) center/contain no-repeat;

        /* Create a mask using the PNG's alpha */
        -webkit-mask: url(objects/chest/chest.png) center/contain no-repeat;
        mask: url(objects/chest/chest.png) center/contain no-repeat;
        
        width: 12%;
        height: 16%;
        top: 65.7%;
        left: 53%;
    }
</style>

<script>
    function openChest(){
        if (!GameSave.hasItem('letter')) {
            const interactionBox = document.getElementById('chest_interaction');
            interactionBox.querySelector('.text p').innerText = "Une lettre repose à l'intérieur";
            callTypeWriter("chest");
            AudioManager.playSfx('../../assets/audio/sfx/OuvertureCoffre.mp3');

            // change options to "read letter" and "close"
            const optionsBox = document.getElementById('chest_options');
            optionsBox.innerHTML = `
                <button onclick="pickLetter()">Récupérer</button>
                <button onclick="closeInteraction('chest_interaction');">Fermer</button>
            `;
        } else {
            const interactionBox = document.getElementById('chest_interaction');
            interactionBox.querySelector('.text p').innerText = "Le coffre est vide.";
            callTypeWriter("chest");
        }
    }
    function pickLetter(){
        GameSave.addItem('letter');
        closeInteraction('chest_interaction');
        const interactionBox = document.getElementById('chest_interaction');
        interactionBox.querySelector('.text p').innerText = "Le coffre est vide.";
        // change options to "read letter" and "close"
        const optionsBox = document.getElementById('chest_options');
        optionsBox.innerHTML = `
            <button onclick="closeInteraction('chest_interaction');">Fermer</button>
        `;
        revealInteraction('letter');
    }
</script>